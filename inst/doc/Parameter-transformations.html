<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Parameter-transformations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Parameter-transformations</h1>



<p>To allow for more flexible model estimation, <strong>lessSEM</strong>
offers parameter transformations. This is a feature inspired by OpenMx
(Neale et al., 2016; Pritikin et al., 2015; Hunter 2018). Parameter
transformations can be very powerful and simplify implementing some
specific forms of regularization.</p>
<div id="motivation" class="section level2">
<h2>Motivation</h2>
<p>In longitudinal SEM, it is important to investigate if parameters
stay the same over time (e.g., measurement invariance of loadings). This
can be difficult to decide and may require setting up many different
models manually. Here, regularization techniques can be very handy. For
instance, in the seminal political democracy example, the model is
typically set up as follows (see <code>?lavaan::sem</code>):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="st">     dem60 =~ y1 + a*y2 + b*y3 + c*y4</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="st">     dem65 =~ y5 + a*y6 + b*y7 + c*y8</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Note that the loadings a, b, and c are assumed to stay the same over
time. That is, measurement invariance is assumed! Relaxing this
assumption, we could define the model as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="st">     dem60 =~ y1 + a1*y2 + b1*y3 + c1*y4</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="st">     dem65 =~ y5 + a2*y6 + b2*y7 + c2*y8</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Here, each loading is estimated separately. This results in a more
complex model. How do we know which model to use? There are many
procedures to answer this question (e.g., using modification indexes,
setting up separate models by hand, etc.). In the following, we will
show how regularization could be used (see e.g., Belzak &amp; Bauer,
2020; Jacobucci &amp; Grimm, 2018).</p>
</div>
<div id="using-regularization" class="section level2">
<h2>Using Regularization</h2>
<p>First, note that measurement invariance can be rephrased as <span class="math inline">\(a_1-a_2 = 0\)</span>, <span class="math inline">\(b_1-b_2 = 0\)</span>, and <span class="math inline">\(c_1-c_2 = 0\)</span>. Thus, regularizing the
differences between these parameters may allow for testing measurement
invariance (e.g., Belzak &amp; Bauer, 2020; Liang et al., 2018; Muthen
&amp; Asparouhov, 2013). In fact, this is used in Bayesian SEM to test
approximate measurement invariance (Liang et al., 2018; Muthen &amp;
Asparouhov, 2013). Similar procedures have also been developed by Huang
(2018) for multi-group differences in parameter estimates and by Fisher
et al. (2022) in vector autoregressive models. Furthermore, Jacobucci
&amp; Grimm (2018) proposed regularizing differences in latent change
score models to test equivalence of autoproportion parameters over time
using a two-step procedure. To this end, there they implemented the
<code>diff_lasso</code> in <strong>regsem</strong> (Jacobucci et al.,
2019). Such a <code>diff_lasso</code> is not available in
<strong>lessSEM</strong>. Instead, <strong>lessSEM</strong> provides a
flexible workaround: parameter transformations. To make this work, we
have to re-define our parameters.</p>
<p>Redefine:</p>
<p><span class="math display">\[
\begin{align}
a_2 &amp;= a_1 + \Delta a_2\\
b_2 &amp;= b_1 + \Delta b_2\\
c_2 &amp;= c_1 + \Delta c_2
\end{align}
\]</span> By regularizing <span class="math inline">\(\Delta
a_2\)</span>, <span class="math inline">\(\Delta b_2\)</span>, and <span class="math inline">\(\Delta c_2\)</span> towards zero, we can enforce
measurement invariance over time.</p>
</div>
<div id="setting-up-the-model" class="section level2">
<h2>Setting up the Model</h2>
<p>We first start with the most flexible model which we want to
test:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="st">     dem60 =~ y1 + a1*y2 + b1*y3 + c1*y4</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="st">     dem65 =~ y5 + a2*y6 + b2*y7 + c2*y8</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>lavaanFit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> modelSyntax,</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>                 <span class="at">data =</span> PoliticalDemocracy)</span></code></pre></div>
<p>Note that the model defined above estimates all parameters time-point
specific. That is, no measurement invariance is assumed.</p>
<p>Now, we want to redefine the parameters as outlined above:</p>
<p><span class="math display">\[
\begin{align}
a_2 &amp;= a_1 + \Delta a_2\\
b_2 &amp;= b_1 + \Delta b_2\\
c_2 &amp;= c_1 + \Delta c_2
\end{align}
\]</span></p>
<p>In <strong>lessSEM</strong> such redefinitions are called
transformations and can be passed to the penalty functions (e.g., to
<code>lasso</code>) using the <code>modifyModel</code> command.</p>
<p>First, we have to create a definition of our transformations:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>transformations <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="st">// IMPORTANT: Our transformations always have to start with the follwing line:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="st">parameters: a1, a2, b1, b2, c1, c2, delta_a2, delta_b2, delta_c2</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="st">// In the line above, we defined the names of the parameters which we</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="st">// want to use in our transformations. EACH AND EVERY PARAMETER USED IN</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="st">// THE FOLLOWING MUST BE STATED ABOVE. The line must always start with</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="st">// the keyword &#39;parameters&#39; followed by a colon. The parameters must be</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="st">// separated by commata.</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="st">// Comments can be added by using double backslash as shown here.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="st">// Now we can state our transformations:</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="st">a2 = a1 + delta_a2; // Note: Each declaration must end with a semi-colon!</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="st">b2 = b1 + delta_b2;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="st">c2 = c1 + delta_c2;</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>Next, we have to pass the <code>transformations</code> variable to
the penalty function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>lassoFit <span class="ot">&lt;-</span> <span class="fu">lasso</span>(<span class="at">lavaanModel =</span> lavaanFit, </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                  <span class="at">regularized =</span> <span class="fu">c</span>(<span class="st">&quot;delta_a2&quot;</span>, <span class="st">&quot;delta_b2&quot;</span>, <span class="st">&quot;delta_c2&quot;</span>),<span class="co"># we want to regularize </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                  <span class="co"># the differences between the parameters</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                  <span class="at">nLambdas =</span> <span class="dv">100</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                  <span class="co"># Our model modification must make use of the modifyModel - function:</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                  <span class="at">modifyModel =</span> <span class="fu">modifyModel</span>(<span class="at">transformations =</span> transformations)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>)</span></code></pre></div>
<p>Let’s have a look at the parameter estimates:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">coef</span>(lassoFit)<span class="sc">@</span>estimates[<span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">10</span>),<span class="fu">c</span>(<span class="st">&quot;a1&quot;</span>, <span class="st">&quot;b1&quot;</span>, <span class="st">&quot;c1&quot;</span>, <span class="st">&quot;delta_a2&quot;</span>, <span class="st">&quot;delta_b2&quot;</span>, <span class="st">&quot;delta_c2&quot;</span>)]</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;             a1       b1       c1     delta_a2    delta_b2 delta_c2</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.210993 1.167936 1.234011  0.000000000 0.000000000        0</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.211114 1.166390 1.234046  0.000000000 0.002702789        0</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.212584 1.150753 1.234650  0.000000000 0.030080792        0</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.214347 1.135698 1.235563  0.000000000 0.057049529        0</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.216419 1.121154 1.236776  0.000000000 0.083716111        0</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;  [6,] 1.218762 1.107040 1.238259  0.000000000 0.110187427        0</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  [7,] 1.221414 1.093407 1.240046  0.000000000 0.136498978        0</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;  [8,] 1.226629 1.080063 1.242051 -0.003960392 0.162516933        0</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;  [9,] 1.246435 1.067714 1.244329 -0.032144145 0.186302860        0</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; [10,] 1.266524 1.055803 1.247136 -0.060258715 0.210141745        0</span></span></code></pre></div>
<p>Note that the differences between the parameters get smaller with
larger <span class="math inline">\(\lambda\)</span> values. We can also
plot the differences:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(lassoFit)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-9" />
<div class="figcaption">plot of chunk unnamed-chunk-9</div>
</div>
<p>To check if measurement invariance can be assumed, we can select the
best model using information criteria:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">coef</span>(lassoFit, <span class="at">criterion =</span> <span class="st">&quot;BIC&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;                                                                                                                              </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;   Tuning         ||--||  Estimates                                                                                           </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;  ------- ------- ||--|| ---------- ---------- ---------- ---------- ---------- ----------- ----------- ----------- ----------</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;   lambda   alpha ||--||  ind60=~x2  ind60=~x3         a1         b1         c1 dem60~ind60 dem65~ind60 dem65~dem60     y1~~y5</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;  ======= ======= ||--|| ========== ========== ========== ========== ========== =========== =========== =========== ==========</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;   0.2216  1.0000 ||--||     2.1825     1.8189     1.2110     1.1679     1.2340      1.4534      0.5935      0.8659     0.5552</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;      y2~~y4     y3~~y7     y4~~y8     y6~~y8     x1~~x1     x2~~x2     x3~~x3     y1~~y1     y2~~y2     y3~~y3     y4~~y4</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;      1.5947     0.7807     0.6537     1.5350     0.0820     0.1177     0.4675     1.7929     7.3843     5.0175     3.4074</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;                                                                                                                            </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;                                                                                                                      ||--||</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ------------ ------------ ------------ ---------- ---------- ---------- ||--||</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;      y5~~y5     y6~~y6     y7~~y7     y8~~y8 ind60~~ind60 dem60~~dem60 dem65~~dem65   delta_a2   delta_b2   delta_c2 ||--||</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ============ ============ ============ ========== ========== ========== ||--||</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;      2.2857     4.8977     3.5510     3.4511       0.4480       3.9408       0.2034          .          .          . ||--||</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt;                                  </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;   Transform                      </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ----------</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;          a2         b2         c2</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ==========</span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt;      1.2110     1.1679     1.2340</span></span></code></pre></div>
<p>Note that all differences have been zeroed – that is, a model with
full measurement invariance did fit best.</p>
<p>We can also access the transformed parameters:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">head</span>(lassoFit<span class="sc">@</span>transformations)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt;      lambda alpha       a2       b2       c2</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; 1 0.2410976     1 1.210993 1.167936 1.234011</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; 2 0.2386623     1 1.210996 1.167933 1.234011</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; 3 0.2362270     1 1.210997 1.167935 1.234010</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; 4 0.2337916     1 1.210992 1.167933 1.234006</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; 5 0.2313563     1 1.210991 1.167933 1.234001</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; 6 0.2289210     1 1.210987 1.167932 1.234000</span></span></code></pre></div>
<p>Limitation: Above, we did not take into account that the variables
may have different scales; a thorough use of the method should scale the
data first.</p>
</div>
<div id="some-guidelines" class="section level2">
<h2>Some Guidelines</h2>
<p>When using transformations, please make sure to give your parameters
names which are compatible with standard naming conventions in R. The
default names of lavaan (e.g., <code>f=~y1</code> for loadings) are not
supported. That is, all parameters used in the transformations should be
given names in the lavaan syntax.</p>
<p>In the example above, we used the following syntax:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="st">     dem60 =~ y1 + a1*y2 + b1*y3 + c1*y4</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="st">     dem65 =~ y5 + a2*y6 + b2*y7 + c2*y8</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>Importantly, all parameters used in the transformation
(<code>a1, b1, c1, a2, b2, c2</code>) were labeled in the lavaan syntax.
As a counter example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="st">     dem60 =~ y1 + y2 + y3 + y4</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="st">     dem65 =~ y5 + y6 + y7 + y8</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="st">&#39;</span></span></code></pre></div>
<p>The syntax above specifies the same model, but will use the
lavaan-specific naming convention for the parameters. <code>a1</code>,
for example, will be named <code>dem60=~y2</code>. These names are not
compatible with the current implementation of transformations used in
<strong>lessSEM</strong>.</p>
</div>
<div id="further-examples" class="section level2">
<h2>Further Examples</h2>
<p>Another example where the transformations could be useful is when
detecting non-stationarity in autoregressive and cross-lagged parameters
(e.g., Liang et al., 2018). In the following, we will demonstrate this
with an autoregressive model. The model is defined as:</p>
<p><span class="math display">\[
\begin{align}
\eta_t &amp;= a_t\eta_{t-1} + \zeta_t\\
\begin{bmatrix}
y_{1,t}\\
y_{2,t}\\
y_{3,t}\\
\end{bmatrix} &amp;= \begin{bmatrix}
l_1\\
l_2\\
l_3\\
\end{bmatrix} \eta_t + \pmb\varepsilon
\end{align}
\]</span></p>
<p>It is often assumed that the autoregressive effect <span class="math inline">\(a_t\)</span> is constant over time; that is, the
same autoregressive effect is used for all time points. This is a strong
assumption and we may want to test it. One way to do so is by using the
same procedure outlined above, where we define <span class="math inline">\(a_t = a_1 + \Delta a_t\)</span> (see Jacobucci
&amp; Grimm, 2018 for a similar procedure in latent change score
models). In this case, each autoregressive effect is composed of the
first autoregressive effect (<span class="math inline">\(a_1\)</span>)
and the difference between the parameters (<span class="math inline">\(\Delta a_t\)</span>). By regularizing <span class="math inline">\(\Delta a_t\)</span>, we can enforce
stationarity.</p>
<p>A drawback of the approach outlined above is that the first
autoregressive effect is treated differently from the rest: After all,
why should <span class="math inline">\(a_1\)</span> serve as baseline
and not <span class="math inline">\(a_2\)</span> or <span class="math inline">\(a_5\)</span>? We will take a slightly different
approach that is basically identical to the fused lasso proposed by
Tibshirani et al. (2005). Let’s define the autoregressive effect as</p>
<p><span class="math display">\[a_t = a_{t-1} + \Delta a_t\]</span></p>
<p>Note that <span class="math inline">\(\Delta a_t\)</span> is no
longer the difference with respect to the initial autoregressive effect
<span class="math inline">\(a_1\)</span> but the difference with respect
to the directly preceding time point. When regularizing <span class="math inline">\(\Delta a_t\)</span>, we can now detect sudden
changes in the parameter – e.g., due to an intervention. This can also
be thought of as a regime switching model, where the underlying model
changes over time (see also Ou et al., 2019 for regime switching
models). With our regularization procedure, we want to detect if and
when the process changes.</p>
<p>We won’t go into the details of how to set up the model here, but you
can find them in the source of this file (<a href="https://github.com/jhorzek/lessSEM/blob/main/vignettes/Parameter-transformations.Rmd">e.g.,
in GitHub</a>). We simulated a data set with 200 individuals measured at
10 time points. The autoregressive effect <span class="math inline">\(a_t\)</span> changes at <span class="math inline">\(t=4\)</span> from <span class="math inline">\(.6\)</span> to <span class="math inline">\(.2\)</span>.</p>
<p>The data looks as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt;           y1_t1       y2_t1       y3_t1      y1_t2      y2_t2      y3_t2      y1_t3       y2_t3      y3_t3       y1_t4</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.2627294 -0.07745288 -0.06014729  1.1052896 -0.5125258  0.1352253  0.6775861  0.48382200  0.5163607  0.06936298</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; [2,] -0.5795123  0.27989039 -1.76295329 -1.1646535  0.0607009 -0.7770722 -0.4571539 -0.30575453  0.7552239  0.06618071</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; [3,]  0.5746526  0.67203557  1.30772224  0.5620735  1.3873269  1.2415508  0.8255529 -0.09010965  1.5877450  0.75756487</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; [4,]  1.6376973  1.30880439  1.35159277  0.4681794  1.5370870  0.6961462  0.1872212 -1.57377418  1.1081811 -0.50832183</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; [5,]  0.4995286 -0.23722728  0.61244148  0.3469646  0.3052115  0.2639443  1.3768225  0.02394048  1.1573912  1.30350064</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; [6,] -0.9766373  0.94700260 -0.59421930 -0.3197840  0.8221090 -0.6808501 -0.3434095 -0.90348981 -1.1760506 -1.72146444</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt;           y2_t4      y3_t4      y1_t5      y2_t5      y3_t5      y1_t6      y2_t6       y3_t6      y1_t7      y2_t7      y3_t7</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; [1,]  1.6842420  0.5604284 -1.6171372 -1.5100658 -2.1212448 -0.9014921 -0.9732405 -0.89209997 -1.4697023 -0.9088437 -2.1031570</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; [2,] -1.5803092  0.1672394  0.1045129  0.3483139 -0.3669688 -0.6347357 -1.1095700  0.01821975  0.3845160  1.0140172  1.8585956</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; [3,]  1.3579232 -0.1379793 -1.1968405 -0.3623344 -0.8732056 -0.8290071 -0.3555817 -0.98268524 -1.8270782 -0.2335533 -1.6441484</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; [4,]  1.1968847 -1.6473363  0.4423361 -1.0372594 -0.8153181 -1.6003121 -2.1169045 -0.46541710  1.3226249  1.7154104  1.8113749</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; [5,]  0.3049751 -0.0146624  1.3351806  0.1229075  0.8274846  0.4508487  0.1328104  0.65883759 -0.3915346 -0.5549143 -0.2476716</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; [6,] -1.2828716 -0.4379788  1.0261730  0.1686185  0.6083559 -0.7427341  0.4514472 -1.15435404  1.7453347  1.2488910  0.6649188</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt;           y1_t8       y2_t8      y3_t8       y1_t9      y2_t9      y3_t9      y1_t10      y2_t10     y3_t10</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; [1,]  0.9915954  0.26021125  1.2988304  1.27416201  1.2010039  1.1426722  0.04668192 -0.24123204 -0.4421784</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; [2,] -1.1280623  0.62646559 -0.8323908 -0.41574193 -0.6890046 -1.4714503 -0.01788118  0.02058262  0.3191417</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; [3,] -0.2693417  0.09757043  0.5752644  0.37098052 -0.3486185 -0.4273464 -0.87844796 -1.36443913 -1.0240934</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; [4,]  0.3459617  0.29614603  0.2463911  0.55566216  1.2444869  0.1788493  0.81351163 -0.39685221  3.3330365</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; [5,] -1.3659303  1.14721685 -0.1968243 -1.58477183 -1.8546910  0.7432728  0.89776939  1.05624257  0.3635211</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; [6,] -0.6131110 -0.27533871  0.1895920  0.02486185 -0.5151950 -0.2018260  1.13097234  0.74034559  2.5292256</span></span></code></pre></div>
<p>The lavaan model is defined as follows:</p>
<pre><code>#&gt; eta2 ~ a1*eta1
#&gt; eta3 ~ a2*eta2
#&gt; eta4 ~ a3*eta3
#&gt; eta5 ~ a4*eta4
#&gt; eta6 ~ a5*eta5
#&gt; eta7 ~ a6*eta6
#&gt; eta8 ~ a7*eta7
#&gt; eta9 ~ a8*eta8
#&gt; eta10 ~ a9*eta9
#&gt; 
#&gt; 
#&gt; eta1 ~~ eta1
#&gt; eta2 ~~ v*eta2
#&gt; eta3 ~~ v*eta3
#&gt; eta4 ~~ v*eta4
#&gt; eta5 ~~ v*eta5
#&gt; eta6 ~~ v*eta6
#&gt; eta7 ~~ v*eta7
#&gt; eta8 ~~ v*eta8
#&gt; eta9 ~~ v*eta9
#&gt; eta10 ~~ v*eta10
#&gt; 
#&gt; eta1 =~ 1*y1_t1 + l2*y2_t1 + l3*y3_t1
#&gt; y1_t1 ~~ mvar1*y1_t1
#&gt; y2_t1 ~~ mvar2*y2_t1
#&gt; y3_t1 ~~ mvar3*y3_t1
#&gt; eta2 =~ 1*y1_t2 + l2*y2_t2 + l3*y3_t2
#&gt; y1_t2 ~~ mvar1*y1_t2
#&gt; y2_t2 ~~ mvar2*y2_t2
#&gt; y3_t2 ~~ mvar3*y3_t2
#&gt; eta3 =~ 1*y1_t3 + l2*y2_t3 + l3*y3_t3
#&gt; y1_t3 ~~ mvar1*y1_t3
#&gt; y2_t3 ~~ mvar2*y2_t3
#&gt; y3_t3 ~~ mvar3*y3_t3
#&gt; eta4 =~ 1*y1_t4 + l2*y2_t4 + l3*y3_t4
#&gt; y1_t4 ~~ mvar1*y1_t4
#&gt; y2_t4 ~~ mvar2*y2_t4
#&gt; y3_t4 ~~ mvar3*y3_t4
#&gt; eta5 =~ 1*y1_t5 + l2*y2_t5 + l3*y3_t5
#&gt; y1_t5 ~~ mvar1*y1_t5
#&gt; y2_t5 ~~ mvar2*y2_t5
#&gt; y3_t5 ~~ mvar3*y3_t5
#&gt; eta6 =~ 1*y1_t6 + l2*y2_t6 + l3*y3_t6
#&gt; y1_t6 ~~ mvar1*y1_t6
#&gt; y2_t6 ~~ mvar2*y2_t6
#&gt; y3_t6 ~~ mvar3*y3_t6
#&gt; eta7 =~ 1*y1_t7 + l2*y2_t7 + l3*y3_t7
#&gt; y1_t7 ~~ mvar1*y1_t7
#&gt; y2_t7 ~~ mvar2*y2_t7
#&gt; y3_t7 ~~ mvar3*y3_t7
#&gt; eta8 =~ 1*y1_t8 + l2*y2_t8 + l3*y3_t8
#&gt; y1_t8 ~~ mvar1*y1_t8
#&gt; y2_t8 ~~ mvar2*y2_t8
#&gt; y3_t8 ~~ mvar3*y3_t8
#&gt; eta9 =~ 1*y1_t9 + l2*y2_t9 + l3*y3_t9
#&gt; y1_t9 ~~ mvar1*y1_t9
#&gt; y2_t9 ~~ mvar2*y2_t9
#&gt; y3_t9 ~~ mvar3*y3_t9
#&gt; eta10 =~ 1*y1_t10 + l2*y2_t10 + l3*y3_t10
#&gt; y1_t10 ~~ mvar1*y1_t10
#&gt; y2_t10 ~~ mvar2*y2_t10
#&gt; y3_t10 ~~ mvar3*y3_t10</code></pre>
<p>We fit the model using lavaan:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>lavaanFit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> lavaanSyntax, </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                 <span class="at">data =</span> data,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                 <span class="at">orthogonal.y =</span> <span class="cn">TRUE</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                 <span class="at">orthogonal.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                 <span class="at">missing =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">coef</span>(lavaanFit)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt;         a1         a2         a3         a4         a5         a6         a7         a8         a9 eta1~~eta1          v </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;      0.484      0.535      0.531      0.135      0.124      0.040      0.173      0.296      0.185      1.108      0.804 </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;          v          v          v          v          v          v          v          v         l2         l3      mvar1 </span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;      0.804      0.804      0.804      0.804      0.804      0.804      0.804      0.804      0.567      0.672      0.049 </span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;      mvar2      mvar3         l2         l3      mvar1      mvar2      mvar3         l2         l3      mvar1      mvar2 </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;      0.744      0.652      0.567      0.672      0.049      0.744      0.652      0.567      0.672      0.049      0.744 </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;      mvar3         l2         l3      mvar1      mvar2      mvar3         l2         l3      mvar1      mvar2      mvar3 </span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;      0.652      0.567      0.672      0.049      0.744      0.652      0.567      0.672      0.049      0.744      0.652 </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;         l2         l3      mvar1      mvar2      mvar3         l2         l3      mvar1      mvar2      mvar3         l2 </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;      0.567      0.672      0.049      0.744      0.652      0.567      0.672      0.049      0.744      0.652      0.567 </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;         l3      mvar1      mvar2      mvar3         l2         l3      mvar1      mvar2      mvar3         l2         l3 </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;      0.672      0.049      0.744      0.652      0.567      0.672      0.049      0.744      0.652      0.567      0.672 </span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;      mvar1      mvar2      mvar3    y1_t1~1    y2_t1~1    y3_t1~1    y1_t2~1    y2_t2~1    y3_t2~1    y1_t3~1    y2_t3~1 </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;      0.049      0.744      0.652     -0.155     -0.088     -0.175     -0.157     -0.049     -0.085     -0.150     -0.030 </span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt;    y3_t3~1    y1_t4~1    y2_t4~1    y3_t4~1    y1_t5~1    y2_t5~1    y3_t5~1    y1_t6~1    y2_t6~1    y3_t6~1    y1_t7~1 </span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;     -0.157     -0.095     -0.022     -0.080      0.037     -0.023      0.058      0.050      0.065     -0.002     -0.047 </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt;    y2_t7~1    y3_t7~1    y1_t8~1    y2_t8~1    y3_t8~1    y1_t9~1    y2_t9~1    y3_t9~1   y1_t10~1   y2_t10~1   y3_t10~1 </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt;      0.068     -0.038     -0.022     -0.028     -0.048     -0.077     -0.058     -0.041      0.013     -0.012     -0.004</span></span></code></pre></div>
<p>Note that no constraints on autoregressive effects are implemented –
each effect (a1-a9) is estimated separately.</p>
<p>We now define transformations as follows:</p>
<pre><code>#&gt; parameters: a1, a2, a3, a4, a5, a6, a7, a8, a9, delta2, delta3, delta4, delta5, delta6, delta7, delta8, delta9
#&gt; 
#&gt; a2 = a1 + delta2;
#&gt; a3 = a2 + delta3;
#&gt; a4 = a3 + delta4;
#&gt; a5 = a4 + delta5;
#&gt; a6 = a5 + delta6;
#&gt; a7 = a6 + delta7;
#&gt; a8 = a7 + delta8;
#&gt; a9 = a8 + delta9;</code></pre>
<p>Finally, we can fit our model:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>lassoFit <span class="ot">&lt;-</span> <span class="fu">lasso</span>(<span class="at">lavaanModel =</span> lavaanFit, </span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                  <span class="at">regularized =</span> <span class="fu">paste0</span>(<span class="st">&quot;delta&quot;</span>, <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>),<span class="co"># we want to regularize </span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                  <span class="co"># the differences between the parameters</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                  <span class="at">nLambdas =</span> <span class="dv">100</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                  <span class="co"># glmnet is considerably faster here:</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;glmnet&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">controlGlmnet</span>(),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>                  <span class="co"># Our model modification must make use of the modifyModel - function:</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>                  <span class="at">modifyModel =</span> <span class="fu">modifyModel</span>(<span class="at">transformations =</span> transformations)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>)</span></code></pre></div>
<p>Extracting the best fitting model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">coef</span>(lassoFit, <span class="at">criterion =</span> <span class="st">&quot;BIC&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co">#&gt;                                                                                                                           </span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;   Tuning         ||--||  Estimates                                                                                        </span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt;  ------- ------- ||--|| ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt;   lambda   alpha ||--||         a1 eta1~~eta1          v         l2         l3      mvar1      mvar2      mvar3    y1_t1~1</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt;  ======= ======= ||--|| ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt;   0.2790  1.0000 ||--||     0.4665     1.1055     0.8051     0.5696     0.6754     0.0533     0.7428     0.6500    -0.1545</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt;     y2_t1~1    y3_t1~1    y1_t2~1    y2_t2~1    y3_t2~1    y1_t3~1    y2_t3~1    y3_t3~1    y1_t4~1    y2_t4~1    y3_t4~1</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt;     -0.0878    -0.1745    -0.1565    -0.0492    -0.0849    -0.1499    -0.0302    -0.1572    -0.0952    -0.0224    -0.0798</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt;     y1_t5~1    y2_t5~1    y3_t5~1    y1_t6~1    y2_t6~1    y3_t6~1    y1_t7~1    y2_t7~1    y3_t7~1    y1_t8~1    y2_t8~1</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt;      0.0374    -0.0231     0.0576     0.0502     0.0651    -0.0020    -0.0466     0.0678    -0.0383    -0.0221    -0.0279</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt;                                                                                                                          </span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt;     y3_t8~1    y1_t9~1    y2_t9~1    y3_t9~1   y1_t10~1   y2_t10~1   y3_t10~1     delta2     delta3     delta4     delta5</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt;     -0.0476    -0.0775    -0.0579    -0.0407     0.0131    -0.0118    -0.0043          .          .    -0.2807          .</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt;                                                                                                                      </span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt;                                              ||--||  Transform                                                       </span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ---------- ||--|| ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt;      delta6     delta7     delta8     delta9 ||--||         a2         a3         a4         a5         a6         a7</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ========== ||--|| ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt;           .          .          .          . ||--||     0.4665     0.4665     0.1859     0.1859     0.1859     0.1859</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt;                       </span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt;                       </span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt;  ---------- ----------</span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt;          a8         a9</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt;  ========== ==========</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt;      0.1859     0.1859</span></span></code></pre></div>
<p>The true autoregressive effects are given by</p>
<pre><code>#&gt; [1] 0.6 0.6 0.6 0.2 0.2 0.2 0.2 0.2 0.2</code></pre>
<p>while the estimates are</p>
<pre><code>#&gt; [1] 0.4665209 0.4665209 0.4665209 0.1858669 0.1858669 0.1858669 0.1858669 0.1858669 0.1858669</code></pre>
<p>The result is not perfect, but <strong>lessSEM</strong> correctly
identified a change in the autoregressive parameter.</p>
</div>
<div id="looking-under-the-hood" class="section level2">
<h2>Looking under the hood</h2>
<p>The transformations used above are implemented using <a href="https://github.com/RcppCore/RcppArmadillo">RcppArmadillo</a>. This
allows for a lot more complicated transformations than those outlined
before. In general, <strong>lessSEM</strong> will take your
transformations and try to translate them to C++. Let’s assume that the
model is given by our first example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>modelSyntax <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="st">  # latent variable definitions</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="st">     dem60 =~ y1 + a1*y2 + b1*y3 + c1*y4</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="st">     dem65 =~ y5 + a2*y6 + b2*y7 + c2*y8</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="st">  # regressions</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="st">    dem60 ~ ind60</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="st">  # residual correlations</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="st">    y1 ~~ y5</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="st">    y2 ~~ y4 </span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="st">    y3 ~~ y7</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="st">    y4 ~~ y8</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="st">    y6 ~~ y8</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>lavaanFit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> modelSyntax, </span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>                 <span class="at">data =</span> PoliticalDemocracy)</span></code></pre></div>
<p>We defined the transformations to be:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>transformations <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="st">parameters: a1, a2, b1, b2, c1, c2, delta_a2, delta_b2, delta_c2</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="st">a2 = a1 + delta_a2;</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="st">b2 = b1 + delta_b2;</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="st">c2 = c1 + delta_c2;</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>When this transformation is passed to <strong>lessSEM</strong>,
<strong>lessSEM</strong> will first try to figure out which parameters
are already in the model and which ones are new. In our case a1, a2, b1,
b2, c1, and c2 are already known, while delta_a2, delta_b2, and delta_c2
are new. <strong>lessSEM</strong> will now add the new parameters to the
internal parameter vector. Next, <strong>lessSEM</strong> will scan the
names of the parameters which appear on the left hand side of an
equation (a2, b2, and c2) in our case. This will tell
<strong>lessSEM</strong> which of your parameters are functions of other
parameters (i.e., transformations). Knowing that a2 is a function of
other parameters will tell <strong>lessSEM</strong>, that a2 should no
longer be estimated. Instead, the parameters which make up a2 are
estimated: a1 and delta_a2.</p>
<p>To see this in action, we can create the C++ function without
compilation:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>transformationFunction <span class="ot">&lt;-</span> lessSEM<span class="sc">:::</span><span class="fu">.compileTransformations</span>(<span class="at">syntax =</span> transformations, </span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>                                                            <span class="at">parameterLabels =</span> <span class="fu">names</span>(<span class="fu">getLavaanParameters</span>(lavaanFit)),</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                                                            <span class="at">compile =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>First, let’s have a look at the extended parameter vector:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>transformationFunction<span class="sc">$</span>parameters</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a1&quot;       &quot;a2&quot;       &quot;b1&quot;       &quot;b2&quot;       &quot;c1&quot;       &quot;c2&quot;       &quot;delta_a2&quot; &quot;delta_b2&quot; &quot;delta_c2&quot;</span></span></code></pre></div>
<p>Note that delta_a2, delta_b2, and delta_c2 have been added. Some of
these are transformations of other parameters:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>transformationFunction<span class="sc">$</span>isTransformation</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;a2&quot; &quot;b2&quot; &quot;c2&quot;</span></span></code></pre></div>
<p>These will not be estimated but computed based on the other model
parameters.</p>
<p>Finally, the C++ function has been returned:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">cat</span>(transformationFunction<span class="sc">$</span>armaFunction)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt;   // [[Rcpp::depends(RcppArmadillo)]]</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt;   #include &lt;RcppArmadillo.h&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt;   // [[Rcpp::export]]</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt;   Rcpp::NumericVector transformationFunction(Rcpp::NumericVector&amp; parameterValues, Rcpp::List transformationList)</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt;   {</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt;   using namespace Rcpp;</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt;   using namespace arma;</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt;   // extract required parameters from parameterValues</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt; double a1 = parameterValues[&quot;a1&quot;];</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt; double a2 = parameterValues[&quot;a2&quot;];</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt; double b1 = parameterValues[&quot;b1&quot;];</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt; double b2 = parameterValues[&quot;b2&quot;];</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt; double c1 = parameterValues[&quot;c1&quot;];</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt; double c2 = parameterValues[&quot;c2&quot;];</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt; double delta_a2 = parameterValues[&quot;delta_a2&quot;];</span></span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a><span class="co">#&gt; double delta_b2 = parameterValues[&quot;delta_b2&quot;];</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a><span class="co">#&gt; double delta_c2 = parameterValues[&quot;delta_c2&quot;];</span></span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a><span class="co">#&gt; // add user defined functions</span></span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a><span class="co">#&gt; a2 = a1 + delta_a2;</span></span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a><span class="co">#&gt; b2 = b1 + delta_b2;</span></span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a><span class="co">#&gt; c2 = c1 + delta_c2;</span></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a><span class="co">#&gt; // update parameters</span></span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;a1&quot;] = a1;</span></span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;a2&quot;] = a2;</span></span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;b1&quot;] = b1;</span></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;b2&quot;] = b2;</span></span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;c1&quot;] = c1;</span></span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;c2&quot;] = c2;</span></span>
<span id="cb25-40"><a href="#cb25-40" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;delta_a2&quot;] = delta_a2;</span></span>
<span id="cb25-41"><a href="#cb25-41" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;delta_b2&quot;] = delta_b2;</span></span>
<span id="cb25-42"><a href="#cb25-42" tabindex="-1"></a><span class="co">#&gt; parameterValues[&quot;delta_c2&quot;] = delta_c2;</span></span>
<span id="cb25-43"><a href="#cb25-43" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-44"><a href="#cb25-44" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb25-45"><a href="#cb25-45" tabindex="-1"></a><span class="co">#&gt;   return(parameterValues);</span></span>
<span id="cb25-46"><a href="#cb25-46" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb25-47"><a href="#cb25-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-48"><a href="#cb25-48" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb25-49"><a href="#cb25-49" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb25-50"><a href="#cb25-50" tabindex="-1"></a><span class="co">#&gt;   // Dirk Eddelbuettel at</span></span>
<span id="cb25-51"><a href="#cb25-51" tabindex="-1"></a><span class="co">#&gt;   // https://gallery.rcpp.org/articles/passing-cpp-function-pointers/</span></span>
<span id="cb25-52"><a href="#cb25-52" tabindex="-1"></a><span class="co">#&gt; typedef Rcpp::NumericVector (*transformationFunctionPtr)(Rcpp::NumericVector&amp;, //parameters</span></span>
<span id="cb25-53"><a href="#cb25-53" tabindex="-1"></a><span class="co">#&gt; Rcpp::List // transformationList</span></span>
<span id="cb25-54"><a href="#cb25-54" tabindex="-1"></a><span class="co">#&gt; );</span></span>
<span id="cb25-55"><a href="#cb25-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-56"><a href="#cb25-56" tabindex="-1"></a><span class="co">#&gt; typedef Rcpp::XPtr&lt;transformationFunctionPtr&gt; transformationFunctionPtr_t;</span></span>
<span id="cb25-57"><a href="#cb25-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-58"><a href="#cb25-58" tabindex="-1"></a><span class="co">#&gt; // [[Rcpp::export]]</span></span>
<span id="cb25-59"><a href="#cb25-59" tabindex="-1"></a><span class="co">#&gt; transformationFunctionPtr_t getPtr() {</span></span>
<span id="cb25-60"><a href="#cb25-60" tabindex="-1"></a><span class="co">#&gt;         return(transformationFunctionPtr_t(new transformationFunctionPtr(&amp;transformationFunction)));</span></span>
<span id="cb25-61"><a href="#cb25-61" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
<p>Most importantly, note that the first step here is to extract the
required parameters from the parameter vector (e.g.,
<code>double a1 = parameterValues[&quot;a1&quot;];</code>). Next, all of these
parameters are directly available for use in your transformations. This
is why we can simply write <code>a2 = a1 + delta_a2;</code>. Finally,
the transformed parameters are returned. To pass our function to
<strong>lessSEM</strong>, we also create a pointer to our function, but
this is beyond the scope here.</p>
<p>At this point you may be wondering where all the more complicated
transformations are that we promised above. Importantly, you can use any
of the functions implemented in <strong>Rcpp</strong> or
<strong>RcppArmadillo</strong> which can be applied to variables of type
<code>double</code> within your transformations without any in-depth
knowledge of C++. For instance, <strong>RcppArmadillo</strong> comes
with an exponential-function (<code>exp</code>), a <code>pow</code> and
a <code>log</code> function. Making use of this, we can implement a
univariate continuous time SEM (e.g., Voelkle &amp; Oud, 2012). Far
superior versions of this model are implemented in <a href="https://github.com/cdriveraus/ctsem">ctsem</a> and <a href="https://github.com/mhunter1/dynr">dynr</a>) and Arnold et al. (in
submission) recently derived close form solutions for the gradients of
these models which should outperform <strong>lessSEM</strong>
considerably in terms of runtime.</p>
<p>We will use the same model from above, but remove the change in the
autoregressive effect. The code to simulate the data set can be found in
the source of this file (<a href="https://github.com/jhorzek/lessSEM/blob/main/vignettes/Parameter-transformations.Rmd">e.g.,
on GitHub</a>).</p>
<p>The initial model is the same as before, however the autoregressive
effect is constrained to equality over time and so are the manifest
means. We also added an initial mean for latent variable <span class="math inline">\(\eta\)</span> and changed the names of some
variables to make using <strong>ctsem</strong> with this data
easier:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">cat</span>(lavaanSyntax)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt; eta1 ~ a*eta0</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; eta2 ~ a*eta1</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; eta3 ~ a*eta2</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; eta4 ~ a*eta3</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; eta5 ~ a*eta4</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt; eta6 ~ a*eta5</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; eta7 ~ a*eta6</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; eta8 ~ a*eta7</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; eta9 ~ a*eta8</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; eta0 ~~ eta0</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; eta1 ~~ v*eta1</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; eta2 ~~ v*eta2</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; eta3 ~~ v*eta3</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; eta4 ~~ v*eta4</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; eta5 ~~ v*eta5</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; eta6 ~~ v*eta6</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; eta7 ~~ v*eta7</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; eta8 ~~ v*eta8</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; eta9 ~~ v*eta9</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; eta0~1</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; eta0 =~ 1*y1_T0 + l2*y2_T0 + l3*y3_T0</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a><span class="co">#&gt; y1_T0 ~~ mvar1*y1_T0</span></span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a><span class="co">#&gt; y2_T0 ~~ mvar2*y2_T0</span></span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a><span class="co">#&gt; y3_T0 ~~ mvar3*y3_T0</span></span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a><span class="co">#&gt; y1_T0 ~ mMean1*1</span></span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a><span class="co">#&gt; y2_T0 ~ mMean2*1</span></span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a><span class="co">#&gt; y3_T0 ~ mMean3*1</span></span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a><span class="co">#&gt; eta1 =~ 1*y1_T1 + l2*y2_T1 + l3*y3_T1</span></span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a><span class="co">#&gt; y1_T1 ~~ mvar1*y1_T1</span></span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a><span class="co">#&gt; y2_T1 ~~ mvar2*y2_T1</span></span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a><span class="co">#&gt; y3_T1 ~~ mvar3*y3_T1</span></span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a><span class="co">#&gt; y1_T1 ~ mMean1*1</span></span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a><span class="co">#&gt; y2_T1 ~ mMean2*1</span></span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a><span class="co">#&gt; y3_T1 ~ mMean3*1</span></span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a><span class="co">#&gt; eta2 =~ 1*y1_T2 + l2*y2_T2 + l3*y3_T2</span></span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a><span class="co">#&gt; y1_T2 ~~ mvar1*y1_T2</span></span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a><span class="co">#&gt; y2_T2 ~~ mvar2*y2_T2</span></span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a><span class="co">#&gt; y3_T2 ~~ mvar3*y3_T2</span></span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a><span class="co">#&gt; y1_T2 ~ mMean1*1</span></span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a><span class="co">#&gt; y2_T2 ~ mMean2*1</span></span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a><span class="co">#&gt; y3_T2 ~ mMean3*1</span></span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a><span class="co">#&gt; eta3 =~ 1*y1_T3 + l2*y2_T3 + l3*y3_T3</span></span>
<span id="cb26-49"><a href="#cb26-49" tabindex="-1"></a><span class="co">#&gt; y1_T3 ~~ mvar1*y1_T3</span></span>
<span id="cb26-50"><a href="#cb26-50" tabindex="-1"></a><span class="co">#&gt; y2_T3 ~~ mvar2*y2_T3</span></span>
<span id="cb26-51"><a href="#cb26-51" tabindex="-1"></a><span class="co">#&gt; y3_T3 ~~ mvar3*y3_T3</span></span>
<span id="cb26-52"><a href="#cb26-52" tabindex="-1"></a><span class="co">#&gt; y1_T3 ~ mMean1*1</span></span>
<span id="cb26-53"><a href="#cb26-53" tabindex="-1"></a><span class="co">#&gt; y2_T3 ~ mMean2*1</span></span>
<span id="cb26-54"><a href="#cb26-54" tabindex="-1"></a><span class="co">#&gt; y3_T3 ~ mMean3*1</span></span>
<span id="cb26-55"><a href="#cb26-55" tabindex="-1"></a><span class="co">#&gt; eta4 =~ 1*y1_T4 + l2*y2_T4 + l3*y3_T4</span></span>
<span id="cb26-56"><a href="#cb26-56" tabindex="-1"></a><span class="co">#&gt; y1_T4 ~~ mvar1*y1_T4</span></span>
<span id="cb26-57"><a href="#cb26-57" tabindex="-1"></a><span class="co">#&gt; y2_T4 ~~ mvar2*y2_T4</span></span>
<span id="cb26-58"><a href="#cb26-58" tabindex="-1"></a><span class="co">#&gt; y3_T4 ~~ mvar3*y3_T4</span></span>
<span id="cb26-59"><a href="#cb26-59" tabindex="-1"></a><span class="co">#&gt; y1_T4 ~ mMean1*1</span></span>
<span id="cb26-60"><a href="#cb26-60" tabindex="-1"></a><span class="co">#&gt; y2_T4 ~ mMean2*1</span></span>
<span id="cb26-61"><a href="#cb26-61" tabindex="-1"></a><span class="co">#&gt; y3_T4 ~ mMean3*1</span></span>
<span id="cb26-62"><a href="#cb26-62" tabindex="-1"></a><span class="co">#&gt; eta5 =~ 1*y1_T5 + l2*y2_T5 + l3*y3_T5</span></span>
<span id="cb26-63"><a href="#cb26-63" tabindex="-1"></a><span class="co">#&gt; y1_T5 ~~ mvar1*y1_T5</span></span>
<span id="cb26-64"><a href="#cb26-64" tabindex="-1"></a><span class="co">#&gt; y2_T5 ~~ mvar2*y2_T5</span></span>
<span id="cb26-65"><a href="#cb26-65" tabindex="-1"></a><span class="co">#&gt; y3_T5 ~~ mvar3*y3_T5</span></span>
<span id="cb26-66"><a href="#cb26-66" tabindex="-1"></a><span class="co">#&gt; y1_T5 ~ mMean1*1</span></span>
<span id="cb26-67"><a href="#cb26-67" tabindex="-1"></a><span class="co">#&gt; y2_T5 ~ mMean2*1</span></span>
<span id="cb26-68"><a href="#cb26-68" tabindex="-1"></a><span class="co">#&gt; y3_T5 ~ mMean3*1</span></span>
<span id="cb26-69"><a href="#cb26-69" tabindex="-1"></a><span class="co">#&gt; eta6 =~ 1*y1_T6 + l2*y2_T6 + l3*y3_T6</span></span>
<span id="cb26-70"><a href="#cb26-70" tabindex="-1"></a><span class="co">#&gt; y1_T6 ~~ mvar1*y1_T6</span></span>
<span id="cb26-71"><a href="#cb26-71" tabindex="-1"></a><span class="co">#&gt; y2_T6 ~~ mvar2*y2_T6</span></span>
<span id="cb26-72"><a href="#cb26-72" tabindex="-1"></a><span class="co">#&gt; y3_T6 ~~ mvar3*y3_T6</span></span>
<span id="cb26-73"><a href="#cb26-73" tabindex="-1"></a><span class="co">#&gt; y1_T6 ~ mMean1*1</span></span>
<span id="cb26-74"><a href="#cb26-74" tabindex="-1"></a><span class="co">#&gt; y2_T6 ~ mMean2*1</span></span>
<span id="cb26-75"><a href="#cb26-75" tabindex="-1"></a><span class="co">#&gt; y3_T6 ~ mMean3*1</span></span>
<span id="cb26-76"><a href="#cb26-76" tabindex="-1"></a><span class="co">#&gt; eta7 =~ 1*y1_T7 + l2*y2_T7 + l3*y3_T7</span></span>
<span id="cb26-77"><a href="#cb26-77" tabindex="-1"></a><span class="co">#&gt; y1_T7 ~~ mvar1*y1_T7</span></span>
<span id="cb26-78"><a href="#cb26-78" tabindex="-1"></a><span class="co">#&gt; y2_T7 ~~ mvar2*y2_T7</span></span>
<span id="cb26-79"><a href="#cb26-79" tabindex="-1"></a><span class="co">#&gt; y3_T7 ~~ mvar3*y3_T7</span></span>
<span id="cb26-80"><a href="#cb26-80" tabindex="-1"></a><span class="co">#&gt; y1_T7 ~ mMean1*1</span></span>
<span id="cb26-81"><a href="#cb26-81" tabindex="-1"></a><span class="co">#&gt; y2_T7 ~ mMean2*1</span></span>
<span id="cb26-82"><a href="#cb26-82" tabindex="-1"></a><span class="co">#&gt; y3_T7 ~ mMean3*1</span></span>
<span id="cb26-83"><a href="#cb26-83" tabindex="-1"></a><span class="co">#&gt; eta8 =~ 1*y1_T8 + l2*y2_T8 + l3*y3_T8</span></span>
<span id="cb26-84"><a href="#cb26-84" tabindex="-1"></a><span class="co">#&gt; y1_T8 ~~ mvar1*y1_T8</span></span>
<span id="cb26-85"><a href="#cb26-85" tabindex="-1"></a><span class="co">#&gt; y2_T8 ~~ mvar2*y2_T8</span></span>
<span id="cb26-86"><a href="#cb26-86" tabindex="-1"></a><span class="co">#&gt; y3_T8 ~~ mvar3*y3_T8</span></span>
<span id="cb26-87"><a href="#cb26-87" tabindex="-1"></a><span class="co">#&gt; y1_T8 ~ mMean1*1</span></span>
<span id="cb26-88"><a href="#cb26-88" tabindex="-1"></a><span class="co">#&gt; y2_T8 ~ mMean2*1</span></span>
<span id="cb26-89"><a href="#cb26-89" tabindex="-1"></a><span class="co">#&gt; y3_T8 ~ mMean3*1</span></span>
<span id="cb26-90"><a href="#cb26-90" tabindex="-1"></a><span class="co">#&gt; eta9 =~ 1*y1_T9 + l2*y2_T9 + l3*y3_T9</span></span>
<span id="cb26-91"><a href="#cb26-91" tabindex="-1"></a><span class="co">#&gt; y1_T9 ~~ mvar1*y1_T9</span></span>
<span id="cb26-92"><a href="#cb26-92" tabindex="-1"></a><span class="co">#&gt; y2_T9 ~~ mvar2*y2_T9</span></span>
<span id="cb26-93"><a href="#cb26-93" tabindex="-1"></a><span class="co">#&gt; y3_T9 ~~ mvar3*y3_T9</span></span>
<span id="cb26-94"><a href="#cb26-94" tabindex="-1"></a><span class="co">#&gt; y1_T9 ~ mMean1*1</span></span>
<span id="cb26-95"><a href="#cb26-95" tabindex="-1"></a><span class="co">#&gt; y2_T9 ~ mMean2*1</span></span>
<span id="cb26-96"><a href="#cb26-96" tabindex="-1"></a><span class="co">#&gt; y3_T9 ~ mMean3*1</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>lavaanFit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> lavaanSyntax, </span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>                 <span class="at">data =</span> data,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>                 <span class="at">orthogonal.y =</span> <span class="cn">TRUE</span>, </span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>                 <span class="at">orthogonal.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>                 <span class="at">missing =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">getLavaanParameters</span>(lavaanFit)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt;            a   eta0~~eta0            v       eta0~1           l2           l3        mvar1        mvar2        mvar3 </span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt;  0.592770935  0.873870399  0.387065602 -0.091482670  0.578004929  0.745298413  0.127999058  0.750360430  0.577566347 </span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt;       mMean1       mMean2       mMean3 </span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt; -0.026015718  0.005858067 -0.027032832</span></span></code></pre></div>
<p>Now, we define the transformations for the latent variables to turn
our model in a continuous time SEM:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>transformations <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="st">parameters: a, ctA, v, ctV</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="st">// NOTE: We can define starting values for our parameters. This</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="st">// is implemented with the &#39;start:&#39; keyword:</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="st">start: ctA = -.1, ctV = .1</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="st">// We changed the starting values for the ct parameters</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="st">// because the auto-effect ctA should be negative.</span></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="st">a = exp(ctA);</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="st">v = log((1.0/(2.0*ctA))*(exp(2.0*ctA)-1)*pow(ctV,2.0)); // we take</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="st">// the log because lessSEM internally takes the exponential of</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="st">// any variance parameter (v in our case) to avoid negative variances.</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>lessSEMFit <span class="ot">&lt;-</span> <span class="fu">bfgs</span>(<span class="at">lavaanModel =</span> lavaanFit, </span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>                   <span class="co"># Our model modification must make use of the modifyModel - function:</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>                   <span class="at">modifyModel =</span> <span class="fu">modifyModel</span>(<span class="at">transformations =</span> transformations)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>)</span></code></pre></div>
<p>Let’s have a look at the parameter estimates:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">coef</span>(lessSEMFit)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt;                                                                                                                           </span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt;   Tuning         ||--||  Estimates                                                                                        </span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt;  ------- ------- ||--|| ---------- ---------- ---------- ---------- ---------- ---------- ---------- ---------- ----------</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt;   lambda   alpha ||--|| eta0~~eta0     eta0~1         l2         l3      mvar1      mvar2      mvar3     mMean1     mMean2</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt;  ======= ======= ||--|| ========== ========== ========== ========== ========== ========== ========== ========== ==========</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt;   0.0000  0.0000 ||--||     0.8736    -0.0902     0.5780     0.7453     0.1280     0.7504     0.5775    -0.0267     0.0054</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt;                                                               </span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt;                                   ||--||  Transform           </span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt;  ---------- ---------- ---------- ||--|| ---------- ----------</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt;      mMean3        ctA        ctV ||--||          a          v</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">#&gt;  ========== ========== ========== ||--|| ========== ==========</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt;     -0.0276    -0.5228     0.7899 ||--||     0.5928     0.3870</span></span></code></pre></div>
<p>For comparison, we will run the same model with
<strong>ctsem</strong>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">library</span>(ctsemOMX)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>dataCt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data,</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>                <span class="fu">data.frame</span>(<span class="st">&quot;dT1&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>                           <span class="st">&quot;dT2&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>                           <span class="st">&quot;dT3&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>                           <span class="st">&quot;dT4&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>                           <span class="st">&quot;dT5&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>                           <span class="st">&quot;dT6&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>                           <span class="st">&quot;dT7&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>                           <span class="st">&quot;dT8&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data)),</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>                           <span class="st">&quot;dT9&quot;</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">nrow</span>(data))))</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>cModel <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">type =</span> <span class="st">&quot;omx&quot;</span>, </span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>                  <span class="at">n.manifest =</span> <span class="dv">3</span>, </span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>                  <span class="at">n.latent =</span> <span class="dv">1</span>, </span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>                  <span class="at">Tpoints =</span> <span class="dv">10</span>,</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>                  <span class="at">manifestNames =</span> <span class="fu">c</span>(<span class="st">&quot;y1&quot;</span>,<span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>), </span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>                  <span class="at">latentNames =</span> <span class="st">&quot;eta&quot;</span>,</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>                  <span class="at">LAMBDA =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>                                    <span class="st">&quot;l2&quot;</span>,</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>                                    <span class="st">&quot;l3&quot;</span>),<span class="dv">3</span>,<span class="dv">1</span>,<span class="cn">TRUE</span>), </span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>                  <span class="at">DRIFT =</span> <span class="fu">matrix</span>(<span class="st">&quot;a&quot;</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>)</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>cFit <span class="ot">&lt;-</span> <span class="fu">ctFit</span>(<span class="at">dat =</span> dataCt, <span class="at">ctmodelobj =</span> cModel)</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>ctSummary <span class="ot">&lt;-</span> <span class="fu">summary</span>(cFit)</span></code></pre></div>
<p>The parameter <code>ctA</code> in our model corresponds to the
<code>DRIFT</code> parameter in the ctsem summary and the parameter
<code>ctV</code> corresponds to the root of the <code>DIFFUSION</code>
parameter in the ctsem summary:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">coef</span>(lessSEMFit)<span class="sc">@</span>estimates[,<span class="fu">c</span>(<span class="st">&quot;ctA&quot;</span>, <span class="st">&quot;ctV&quot;</span>)]</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co">#&gt;        ctA        ctV </span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a><span class="co">#&gt; -0.5228340  0.7899115</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="co"># drift value from ctsem:</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>ctSummary<span class="sc">$</span>DRIFT</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="co">#&gt;            eta</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="co">#&gt; eta -0.5229469</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="co"># sqrt(diffusion) value from ctsem:</span></span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a><span class="fu">sqrt</span>(ctSummary<span class="sc">$</span>DIFFUSION)</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="co">#&gt;           eta</span></span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a><span class="co">#&gt; eta 0.7900236</span></span></code></pre></div>
<div id="making-use-of-c" class="section level3">
<h3>Making use of C++</h3>
<p>In the example above, we used a univariate ctsem. Because of this,
all our functions were fairly simple in that we only needed the
<code>log</code>, <code>exp</code>, and <code>pow</code> functions for
single variables. However, because <strong>lessSEM</strong> creates a
C++ function, we can build much more powerful transformations if we are
familiar with <strong>RcppArmadillo</strong>. In the following, we will
therefore extend the example to a multivariate continuous time SEM. We
will use the AnomAuth data set from ctsem. The data is included in the
<strong>ctsemOMX</strong> package:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;AnomAuth&quot;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">head</span>(AnomAuth)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co">#&gt;   Y1_T0 Y2_T0 Y1_T1 Y2_T1 Y1_T2 Y2_T2 Y1_T3 Y2_T3 Y1_T4 Y2_T4 dT1 dT2 dT3 dT4</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="co">#&gt; 1  2.67  3.50  3.33   3.5    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a><span class="co">#&gt; 2  3.33  3.25    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="co">#&gt; 3  3.33  2.75  3.33   3.0  3.33   2.5  2.33     3  2.33     3   1   1   2   2</span></span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="co">#&gt; 4  3.33  3.25    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co">#&gt; 5  4.00  4.00    NA    NA    NA    NA    NA    NA    NA    NA   1   1   2   2</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="co">#&gt; 6  3.67  4.00    NA    NA    NA    NA  4.00     4  4.00     4   1   1   2   2</span></span></code></pre></div>
<p>The five measurement occasions are unequally spaced. In a discrete
time model, we could take care of this by implementing a model with
different autoregressive and cross-lagged effects for the different time
intervals:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># initial time point</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>lavaanSyntax <span class="ot">&lt;-</span> </span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="st">&quot;eta1_T0 =~ 1 * Y1_T0</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="st">eta2_T0 =~ 1 * Y2_T0</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="st">Y1_T0 ~~ 0*Y1_T0</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="st">Y2_T0 ~~ 0*Y2_T0</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co"># variances</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>                  <span class="st">&quot;eta1_T0 ~~ v0_11 * eta1_T0 + v0_12 * eta2_T0</span><span class="sc">\n</span><span class="st">eta2_T0 ~~ v0_22 * eta2_T0</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="co"># means</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>                  <span class="st">&quot;eta1_T0 ~ 1</span><span class="sc">\n</span><span class="st">eta2_T0 ~ 1</span><span class="sc">\n</span><span class="st">Y1_T0~mMean1*1</span><span class="sc">\n</span><span class="st">Y2_T0~mMean2*1</span><span class="sc">\n</span><span class="st">&quot;</span> </span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>)</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="cf">for</span>(tp <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)){</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  <span class="cf">if</span>(tp <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="st">&quot;a1&quot;</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="st">&quot;v1&quot;</span></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>    a <span class="ot">&lt;-</span><span class="st">&quot;a2&quot;</span></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="st">&quot;v2&quot;</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a>  }</span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a>  </span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>  <span class="co"># autoregressive and cross-lagged</span></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>  lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>                    <span class="fu">paste0</span>(</span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a>                      <span class="st">&quot;eta1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~ &quot;</span>, a, <span class="st">&quot;_11 * eta1_T&quot;</span>, tp, <span class="st">&quot; + &quot;</span>, a, <span class="st">&quot;_12 * eta2_T&quot;</span>, tp,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a>                      <span class="st">&quot;eta2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~ &quot;</span>, a, <span class="st">&quot;_21 * eta1_T&quot;</span>, tp, <span class="st">&quot; + &quot;</span>, a, <span class="st">&quot;_22 * eta2_T&quot;</span>, tp, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a>                    )</span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a>  )</span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a>  </span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>  <span class="co"># variances</span></span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a>  lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>                    <span class="fu">paste0</span>(</span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a>                      <span class="st">&quot;eta1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~~ &quot;</span>, v, <span class="st">&quot;_11 * eta1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; + &quot;</span>, v, <span class="st">&quot;_12 * eta2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a>                      <span class="st">&quot;eta2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~~ &quot;</span>, v, <span class="st">&quot;_22 * eta2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a>                    )</span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a>  )</span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a>  </span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a>  <span class="co"># loadings</span></span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a>  lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a>                    <span class="fu">paste0</span>(</span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a>                      <span class="st">&quot;eta1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; =~ 1 * Y1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a>                      <span class="st">&quot;eta2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; =~ 1 * Y2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a>                    )</span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a>  )</span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a>  </span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a>  <span class="co"># manifest variances</span></span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a>  lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a>                    <span class="fu">paste0</span>(</span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a>                      <span class="st">&quot;Y1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~~ 0* Y1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a>                      <span class="st">&quot;Y2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~~ 0* Y2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a>                    )</span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a>  )</span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a>  </span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a>  <span class="co"># manifest means</span></span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a>  lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">c</span>(lavaanSyntax,</span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a>                    <span class="fu">paste0</span>(</span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a>                      <span class="st">&quot;Y1_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~ mMean1 * 1</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a>                      <span class="st">&quot;Y2_T&quot;</span>, tp<span class="sc">+</span><span class="dv">1</span>, <span class="st">&quot; ~ mMean2 * 1</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a>                    )</span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a>  )</span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a>}</span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a>lavaanSyntax <span class="ot">&lt;-</span> <span class="fu">paste0</span>(lavaanSyntax, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a><span class="fu">cat</span>(lavaanSyntax)</span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a><span class="co">#&gt; eta1_T0 =~ 1 * Y1_T0</span></span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a><span class="co">#&gt; eta2_T0 =~ 1 * Y2_T0</span></span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a><span class="co">#&gt; Y1_T0 ~~ 0*Y1_T0</span></span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a><span class="co">#&gt; Y2_T0 ~~ 0*Y2_T0</span></span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a><span class="co">#&gt; eta1_T0 ~~ v0_11 * eta1_T0 + v0_12 * eta2_T0</span></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a><span class="co">#&gt; eta2_T0 ~~ v0_22 * eta2_T0</span></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a><span class="co">#&gt; eta1_T0 ~ 1</span></span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a><span class="co">#&gt; eta2_T0 ~ 1</span></span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a><span class="co">#&gt; Y1_T0~mMean1*1</span></span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a><span class="co">#&gt; Y2_T0~mMean2*1</span></span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a><span class="co">#&gt; eta1_T1 ~ a1_11 * eta1_T0 + a1_12 * eta2_T0</span></span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a><span class="co">#&gt; eta2_T1 ~ a1_21 * eta1_T0 + a1_22 * eta2_T0</span></span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a><span class="co">#&gt; eta1_T1 ~~ v1_11 * eta1_T1 + v1_12 * eta2_T1</span></span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a><span class="co">#&gt; eta2_T1 ~~ v1_22 * eta2_T1</span></span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a><span class="co">#&gt; eta1_T1 =~ 1 * Y1_T1</span></span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a><span class="co">#&gt; eta2_T1 =~ 1 * Y2_T1</span></span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a><span class="co">#&gt; Y1_T1 ~~ 0* Y1_T1</span></span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a><span class="co">#&gt; Y2_T1 ~~ 0* Y2_T1</span></span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a><span class="co">#&gt; Y1_T1 ~ mMean1 * 1</span></span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a><span class="co">#&gt; Y2_T1 ~ mMean2 * 1</span></span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a><span class="co">#&gt; eta1_T2 ~ a1_11 * eta1_T1 + a1_12 * eta2_T1</span></span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a><span class="co">#&gt; eta2_T2 ~ a1_21 * eta1_T1 + a1_22 * eta2_T1</span></span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a><span class="co">#&gt; eta1_T2 ~~ v1_11 * eta1_T2 + v1_12 * eta2_T2</span></span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a><span class="co">#&gt; eta2_T2 ~~ v1_22 * eta2_T2</span></span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a><span class="co">#&gt; eta1_T2 =~ 1 * Y1_T2</span></span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a><span class="co">#&gt; eta2_T2 =~ 1 * Y2_T2</span></span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a><span class="co">#&gt; Y1_T2 ~~ 0* Y1_T2</span></span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a><span class="co">#&gt; Y2_T2 ~~ 0* Y2_T2</span></span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a><span class="co">#&gt; Y1_T2 ~ mMean1 * 1</span></span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a><span class="co">#&gt; Y2_T2 ~ mMean2 * 1</span></span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a><span class="co">#&gt; eta1_T3 ~ a2_11 * eta1_T2 + a2_12 * eta2_T2</span></span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a><span class="co">#&gt; eta2_T3 ~ a2_21 * eta1_T2 + a2_22 * eta2_T2</span></span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a><span class="co">#&gt; eta1_T3 ~~ v2_11 * eta1_T3 + v2_12 * eta2_T3</span></span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a><span class="co">#&gt; eta2_T3 ~~ v2_22 * eta2_T3</span></span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a><span class="co">#&gt; eta1_T3 =~ 1 * Y1_T3</span></span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a><span class="co">#&gt; eta2_T3 =~ 1 * Y2_T3</span></span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a><span class="co">#&gt; Y1_T3 ~~ 0* Y1_T3</span></span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a><span class="co">#&gt; Y2_T3 ~~ 0* Y2_T3</span></span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a><span class="co">#&gt; Y1_T3 ~ mMean1 * 1</span></span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a><span class="co">#&gt; Y2_T3 ~ mMean2 * 1</span></span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a><span class="co">#&gt; eta1_T4 ~ a2_11 * eta1_T3 + a2_12 * eta2_T3</span></span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a><span class="co">#&gt; eta2_T4 ~ a2_21 * eta1_T3 + a2_22 * eta2_T3</span></span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a><span class="co">#&gt; eta1_T4 ~~ v2_11 * eta1_T4 + v2_12 * eta2_T4</span></span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a><span class="co">#&gt; eta2_T4 ~~ v2_22 * eta2_T4</span></span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a><span class="co">#&gt; eta1_T4 =~ 1 * Y1_T4</span></span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a><span class="co">#&gt; eta2_T4 =~ 1 * Y2_T4</span></span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a><span class="co">#&gt; Y1_T4 ~~ 0* Y1_T4</span></span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a><span class="co">#&gt; Y2_T4 ~~ 0* Y2_T4</span></span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a><span class="co">#&gt; Y1_T4 ~ mMean1 * 1</span></span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a><span class="co">#&gt; Y2_T4 ~ mMean2 * 1</span></span></code></pre></div>
<p>Setting up the model in lavaan:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>lavaanFit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> lavaanSyntax, <span class="at">data =</span> AnomAuth,</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>                 <span class="at">orthogonal.y =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>                 <span class="at">orthogonal.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>                 <span class="at">missing =</span> <span class="st">&quot;ml&quot;</span>,</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>                 <span class="at">do.fit =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>To transform the parameters to those of a continuous time model, we
have to define the transformations again. We will not go into the
details here. See Voelkle et al. (2012) for the underlying
transformations.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>transformations <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="st">// Define all parameters which we want to use:</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="st">parameters: a1_11, a1_12, a1_21, a1_22, a2_11, a2_12, a2_21, a2_22, </span></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="st">ctA_11, ctA_12, ctA_21, ctA_22, </span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="st">v1_11, v1_12, v1_22, v2_11, v2_12, v2_22, </span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a><span class="st">ctV_11, ctV_12, ctV_22</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="st">// Define the starting values for the continuous time parameters:</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a><span class="st">start: ctA_11 = -1, ctA_12 = 0, ctA_21 = 0, ctA_22 = -1, </span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a><span class="st">ctV_11 = .1, ctV_12 = 0, ctV_22 = .1</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="st">// transformations:</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="st">arma::mat drift(2,2);</span></span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a><span class="st">arma::mat ARCL1(2,2);</span></span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a><span class="st">arma::mat ARCL2(2,2);</span></span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a><span class="st">arma::mat driftHash(4,4);</span></span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a><span class="st">drift(0,0) = ctA_11;</span></span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a><span class="st">drift(1,0) = ctA_21;</span></span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="st">drift(0,1) = ctA_12;</span></span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a><span class="st">drift(1,1) = ctA_22;</span></span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a><span class="st">ARCL1 = expmat(drift);</span></span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a><span class="st">ARCL2 = expmat(drift*2.0);</span></span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a><span class="st">driftHash = kron(drift, arma::eye(2,2)) + kron(arma::eye(2,2), drift);</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a></span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a><span class="st">arma::mat diffusion(2,2);</span></span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a><span class="st">arma::mat discreteDiff1(2,2);</span></span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a><span class="st">arma::mat discreteDiff2(2,2);</span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a><span class="st">diffusion(0,0) = ctV_11;</span></span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a><span class="st">diffusion(1,0) = ctV_12;</span></span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a><span class="st">diffusion(0,1) = ctV_12;</span></span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a><span class="st">diffusion(1,1) = ctV_22;</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a><span class="st">discreteDiff1 = arma::reshape(arma::inv(driftHash) * </span></span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a><span class="st">  (expmat(driftHash) - arma::eye(arma::size(expmat(driftHash))))*</span></span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a><span class="st">  arma::vectorise(diffusion),2,2);</span></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a><span class="st">discreteDiff2 = arma::reshape(arma::inv(driftHash) * </span></span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a><span class="st">  (expmat(driftHash*2.0) - arma::eye(arma::size(expmat(driftHash*2.0))))*</span></span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a><span class="st">  arma::vectorise(diffusion),2,2);</span></span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a><span class="st">// extract parameters</span></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" tabindex="-1"></a><span class="st">a1_11 = ARCL1(0,0);</span></span>
<span id="cb36-43"><a href="#cb36-43" tabindex="-1"></a><span class="st">a1_12 = ARCL1(0,1);</span></span>
<span id="cb36-44"><a href="#cb36-44" tabindex="-1"></a><span class="st">a1_21 = ARCL1(1,0);</span></span>
<span id="cb36-45"><a href="#cb36-45" tabindex="-1"></a><span class="st">a1_22 = ARCL1(1,1);</span></span>
<span id="cb36-46"><a href="#cb36-46" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" tabindex="-1"></a><span class="st">a2_11 = ARCL2(0,0);</span></span>
<span id="cb36-48"><a href="#cb36-48" tabindex="-1"></a><span class="st">a2_12 = ARCL2(0,1);</span></span>
<span id="cb36-49"><a href="#cb36-49" tabindex="-1"></a><span class="st">a2_21 = ARCL2(1,0);</span></span>
<span id="cb36-50"><a href="#cb36-50" tabindex="-1"></a><span class="st">a2_22 = ARCL2(1,1);</span></span>
<span id="cb36-51"><a href="#cb36-51" tabindex="-1"></a></span>
<span id="cb36-52"><a href="#cb36-52" tabindex="-1"></a><span class="st">v1_11 = log(discreteDiff1(0,0)); // we take the log because of the internal </span></span>
<span id="cb36-53"><a href="#cb36-53" tabindex="-1"></a><span class="st">// transformation in lessSEM</span></span>
<span id="cb36-54"><a href="#cb36-54" tabindex="-1"></a><span class="st">v1_12 = discreteDiff1(0,1);</span></span>
<span id="cb36-55"><a href="#cb36-55" tabindex="-1"></a><span class="st">v1_22 = log(discreteDiff1(1,1)); // we take the log because of the internal </span></span>
<span id="cb36-56"><a href="#cb36-56" tabindex="-1"></a><span class="st">// transformation in lessSEM</span></span>
<span id="cb36-57"><a href="#cb36-57" tabindex="-1"></a></span>
<span id="cb36-58"><a href="#cb36-58" tabindex="-1"></a><span class="st">v2_11 = log(discreteDiff2(0,0)); // we take the log because of the internal </span></span>
<span id="cb36-59"><a href="#cb36-59" tabindex="-1"></a><span class="st">// transformation in lessSEM</span></span>
<span id="cb36-60"><a href="#cb36-60" tabindex="-1"></a><span class="st">v2_12 = discreteDiff2(0,1);</span></span>
<span id="cb36-61"><a href="#cb36-61" tabindex="-1"></a><span class="st">v2_22 = log(discreteDiff2(1,1)); // we take the log because of the internal </span></span>
<span id="cb36-62"><a href="#cb36-62" tabindex="-1"></a><span class="st">// transformation in lessSEM</span></span>
<span id="cb36-63"><a href="#cb36-63" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p>Most importantly, we used matrices in our transformations. This is
possible, because <strong>lessSEM</strong> uses
<strong>RcppArmadillo</strong> in the background and therefore also
provides users with all of the functions implemented therein.</p>
<p>As before, we can now fit the model with <strong>lessSEM</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>lessSEMFit <span class="ot">&lt;-</span> <span class="fu">bfgs</span>(<span class="at">lavaanModel =</span> lavaanFit,</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>                   <span class="co"># Our model modification must make use of the modifyModel - function:</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>                   <span class="at">modifyModel =</span> <span class="fu">modifyModel</span>(<span class="at">transformations =</span> transformations)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>)</span></code></pre></div>
<p>For comparison, we will also fit the model with
<strong>ctsemOMX</strong>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>AnomAuthmodel <span class="ot">&lt;-</span> <span class="fu">ctModel</span>(<span class="at">LAMBDA =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>), </span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>                         <span class="at">Tpoints =</span> <span class="dv">5</span>, <span class="at">n.latent =</span> <span class="dv">2</span>, <span class="at">n.manifest =</span> <span class="dv">2</span>, <span class="at">MANIFESTVAR=</span><span class="fu">diag</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">TRAITVAR =</span> <span class="cn">NULL</span>) </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>AnomAuthfit <span class="ot">&lt;-</span> <span class="fu">ctFit</span>(AnomAuth, AnomAuthmodel)</span></code></pre></div>
<p>The following matrices are the drifts of the <strong>lessSEM</strong>
model and the <strong>ctsemOMX</strong> model:</p>
<p>lessSEM:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">coef</span>(lessSEMFit)<span class="sc">@</span>estimates[,<span class="fu">c</span>(<span class="st">&quot;ctA_11&quot;</span>, <span class="st">&quot;ctA_21&quot;</span>, <span class="st">&quot;ctA_12&quot;</span>, <span class="st">&quot;ctA_22&quot;</span>)],<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="co">#&gt; [1,] -0.4481642  0.2320794</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co">#&gt; [2,]  0.0425989 -0.1171247</span></span></code></pre></div>
<p>ctsemOMX:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>AnomAuthfit<span class="sc">$</span>mxobj<span class="sc">$</span>DRIFT<span class="sc">$</span>values</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="co">#&gt;             [,1]       [,2]</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a><span class="co">#&gt; [1,] -0.44728184  0.2324980</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co">#&gt; [2,]  0.04329283 -0.1174662</span></span></code></pre></div>
<p>The diffusions are given by:</p>
<p>lessSEM:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">coef</span>(lessSEMFit)<span class="sc">@</span>estimates[,<span class="fu">c</span>(<span class="st">&quot;ctV_11&quot;</span>, <span class="st">&quot;ctV_12&quot;</span>, <span class="st">&quot;ctV_12&quot;</span>, <span class="st">&quot;ctV_22&quot;</span>)],<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co">#&gt;              [,1]         [,2]</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.473495271 -0.003846946</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co">#&gt; [2,] -0.003846946  0.154505468</span></span></code></pre></div>
<p>ctsemOMX:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>AnomAuthfit<span class="sc">$</span>mxobj<span class="sc">$</span>DIFFUSIONchol<span class="sc">$</span>result<span class="sc">%*%</span><span class="fu">t</span>(AnomAuthfit<span class="sc">$</span>mxobj<span class="sc">$</span>DIFFUSIONchol<span class="sc">$</span>result)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co">#&gt;              [,1]         [,2]</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="co">#&gt; [1,]  0.473241884 -0.004610149</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="co">#&gt; [2,] -0.004610149  0.154509547</span></span></code></pre></div>
<p>Regularization could be used to enforce sparsity (Orzek &amp;
Voelkle, under review):</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>lassoFit <span class="ot">&lt;-</span> <span class="fu">lasso</span>(<span class="at">lavaanModel =</span> lavaanFit, </span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>                  <span class="at">regularized =</span> <span class="st">&quot;ctA_21&quot;</span>,</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>                  <span class="at">nLambdas =</span> <span class="dv">30</span>,</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">&quot;glmnet&quot;</span>,</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>                  <span class="at">control =</span> <span class="fu">controlGlmnet</span>(),</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>                  <span class="co"># Our model modification must make use of the modifyModel - function:</span></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>                  <span class="at">modifyModel =</span> <span class="fu">modifyModel</span>(<span class="at">transformations =</span> transformations)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">plot</span>(lassoFit)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-55" />
<div class="figcaption">plot of chunk unnamed-chunk-55</div>
</div>
<p>Again, all these steps are easier when using dedicated packages such
as <strong>ctsem</strong> and <strong>ctsemOMX</strong> for continuous
time SEM and <strong>regCtsem</strong> (Orzek &amp; Voelkle, under
review) for regularized continuous time SEM.</p>
</div>
</div>
<div id="how-it-is-implemented" class="section level2">
<h2>How it is implemented</h2>
<p>The basic idea behind the transformations is as follows: Assume that
the SEM parameters are given by <span class="math inline">\(\pmb\theta\)</span>. The 2-log-likelihood of the
model is given by <span class="math inline">\(f(\pmb\theta)\)</span>.
When using transformations, we redefine <span class="math inline">\(\pmb\theta\)</span> to be a function of other
parameters, say <span class="math inline">\(\pmb\gamma\)</span>. That
is, <span class="math inline">\(\pmb\theta =\pmb g(\pmb\gamma)\)</span>,
where <span class="math inline">\(\pmb g\)</span> is a function
returning a vector. As a result, we can re-write the fitting function as
<span class="math inline">\(f(\pmb\theta) = f(\pmb
g(\pmb\gamma))\)</span>. Instead of optimizing <span class="math inline">\(\pmb\theta\)</span>, we now optimize <span class="math inline">\(\pmb\gamma\)</span>. Within
<strong>lessSEM</strong>, the gradients of <span class="math inline">\(f(\pmb\theta)\)</span> with respect to <span class="math inline">\(\pmb\theta\)</span> are implemented in closed form
as this results in a considerably faster run time. To get the gradients
of <span class="math inline">\(f(\pmb\theta) = f(\pmb
g(\pmb\gamma))\)</span> with respect to <span class="math inline">\(\pmb\gamma\)</span>, <strong>lessSEM</strong>
makes use of the <a href="https://en.wikipedia.org/wiki/Chain_rule">chain rule</a>. The
gradients of the transformation <span class="math inline">\(\pmb
g(\pmb\gamma)\)</span> are approximated numerically. This is similar to
the procedure by Arnold et al. (in submission) for continuous time SEM,
where the derivative of the matrix exponential is approximated
numerically, while all other elements are derived with closed form
solutions.</p>
</div>
<div id="bibliography" class="section level2">
<h2>Bibliography</h2>
<ul>
<li>Arnold, M., Cancér, P. F., Estrada, E., &amp; Voelkle, M. C. (in
submission). Score-Guided Recursive Partitioning of Continuous-Time
Structural Equation Models.</li>
<li>Belzak, W. C. M., &amp; Bauer, D. J. (2020). Improving the
assessment of measurement invariance: Using regularization to select
anchor items and identify differential item functioning. Psychological
Methods, 25(6), 673–690. <a href="https://doi.org/10.1037/met0000253" class="uri">https://doi.org/10.1037/met0000253</a></li>
<li>Driver, C. C., Oud, J. H. L., &amp; Voelkle, M. C. (2017).
Continuous time structural equation modelling with R package ctsem.
Journal of Statistical Software, 77(5), 1–36. <a href="https://doi.org/10.18637/jss.v077.i05" class="uri">https://doi.org/10.18637/jss.v077.i05</a></li>
<li>Fisher, Z. F., Kim, Y., Fredrickson, B. L., &amp; Pipiras, V.
(2022). Penalized Estimation and Forecasting of Multiple Subject
Intensive Longitudinal Data. Psychometrika, 87(2), 1–29. <a href="https://doi.org/10.1007/s11336-021-09825-7" class="uri">https://doi.org/10.1007/s11336-021-09825-7</a></li>
<li>Huang, P.-H. (2018). A penalized likelihood method for multi-group
structural equation modelling. British Journal of Mathematical and
Statistical Psychology, 71(3), 499–522. <a href="https://doi.org/10.1111/bmsp.12130" class="uri">https://doi.org/10.1111/bmsp.12130</a></li>
<li>Hunter, M. D. (2018). State space modeling in an open source,
modular, structural equation modeling environment. Structural Equation
Modeling, 25(2), 307-324. doi: 10.1080/10705511.2017.1369354</li>
<li>Jacobucci, R., &amp; Grimm, K. J. (2018). Regularized Estimation of
Multivariate Latent Change Score Models. In E. Ferrer, S. M. Boker,
&amp; K. J. Grimm (Eds.), Longitudinal Multivariate Psychology (1st ed.,
pp. 109–125). Routledge. <a href="https://doi.org/10.4324/9781315160542-6" class="uri">https://doi.org/10.4324/9781315160542-6</a></li>
<li>Jacobucci, R., Grimm, K. J., Brandmaier, A. M., Serang, S., Kievit,
R. A., &amp; Scharf, F. (2019). regsem: Regularized structural equation
modeling. <a href="https://CRAN.R-project.org/package=regsem" class="uri">https://CRAN.R-project.org/package=regsem</a></li>
<li>Liang, X., Yang, Y., &amp; Huang, J. (2018). Evaluation of
Structural Relationships in Autoregressive Cross-Lagged Models Under
Longitudinal Approximate Invariance:A Bayesian Analysis. Structural
Equation Modeling: A Multidisciplinary Journal, 25(4), 558–572. <a href="https://doi.org/10.1080/10705511.2017.1410706" class="uri">https://doi.org/10.1080/10705511.2017.1410706</a></li>
<li>Muthen, B., &amp; Asparouhov, T. (2013). BSEM Measurement Invariance
Analysis. Mplus Web Notes: No. 17.</li>
<li>Neale, M. C., Hunter, M. D., Pritikin, J. N., Zahery, M., Brick, T.
R., Kirkpatrick, R. M., Estabrook, R., Bates, T. C., Maes, H. H., &amp;
Boker, S. M. (2016). OpenMx 2.0: Extended structural equation and
statistical modeling. Psychometrika, 81(2), 535–549. <a href="https://doi.org/10.1007/s11336-014-9435-8" class="uri">https://doi.org/10.1007/s11336-014-9435-8</a></li>
<li>Ou, L., Hunter, M., D., &amp; Chow, S.-M. (2019). Whats for dynr: A
package for linear and nonlinear dynamic modeling in r. The R Journal,
11(1), 91–111. <a href="https://doi.org/10.32614/RJ-2019-012" class="uri">https://doi.org/10.32614/RJ-2019-012</a></li>
<li>Orzek, J. H., &amp; Voelkle, M. C. (under review). Regularized
continuous time structural equation models: A network perspective.</li>
<li>Pritikin, J. N., Hunter, M. D., &amp; Boker, S. M. (2015). Modular
open-source software for Item Factor Analysis. Educational and
Psychological Measurement, 75(3), 458-474</li>
<li>Tibshirani, R., Saunders, M., Rosset, S., Zhu, J., &amp; Knight, K.
(2005). Sparsity and smoothness via the fused lasso. Journal of the
Royal Statistical Society: Series B (Statistical Methodology), 67(1),
91–108. <a href="https://doi.org/10.1111/j.1467-9868.2005.00490.x" class="uri">https://doi.org/10.1111/j.1467-9868.2005.00490.x</a></li>
<li>Voelkle, M. C., Oud, J. H. L., Davidov, E., &amp; Schmidt, P.
(2012). An sem approach to continuous time modeling of panel data:
Relating authoritarianism and anomia. Psychological Methods, 17(2),
176–192. <a href="https://doi.org/10.1037/a0027543" class="uri">https://doi.org/10.1037/a0027543</a></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
